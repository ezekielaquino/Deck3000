!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.deck3000=t()}(this,function(){var e,t=(e=e||Object.create(null),{on:function(t,i){(e[t]||(e[t]=[])).push(i)},off:function(t,i){e[t]&&e[t].splice(e[t].indexOf(i)>>>0,1)},emit:function(t,i){(e[t]||[]).slice().map(function(e){e(i)}),(e["*"]||[]).slice().map(function(e){e(t,i)})}}),i=function(e,t){var i;e.index===t.current?i="current":e.index===t.next?i="next":e.index===t.prev?i="prev":e.index>t.current?i="next":e.index<t.current&&(i="prev"),function(e){var t=e.target,i=e.targetClass,n=e.initialClasses,s=e.classNames,r=e.reset,a="next"===e.direction?"is-next":"is-prev";(c=t.classList).add.apply(c,s);var c,o=Array.from(t.classList).filter(function(e){if(e===i||s.includes(e)||n.includes(e))return e});(s.includes(a)||r)&&o.push("is-instant"),t.classList=o.join(" ")}({target:e.element,targetClass:e.className,initialClasses:e.initialClasses,classNames:["is-"+i],direction:t.direction,reset:t.reset})},n=function(e){void 0===e&&(e={}),Object.assign(this,e),this.sectionIndex=e.parentSection.index,this.className=this.parentSection.className+"-slide",this.init()};n.prototype.init=function(){var e=this;if(this.initialClasses=Array.from(this.element.classList),this.element.classList.add(this.className),0===this.parentSection.state.slideLength)return this.element.classList.add("is-current");t.on("navigateSlide",function(t){return e._onNavigate(t)})},n.prototype._onNavigate=function(e){var t=e.direction,n=this.parentSection.state;this.sectionIndex!==e.current&&t||i(this,{current:n.currentSlide,direction:t,next:n.next,prev:n.prev,reset:e.reset})};var s=function(e){void 0===e&&(e={}),Object.assign(this,e),this.className=this.slideshow.baseSelector+"__section",this.state={currentSlide:0},this.init()};s.prototype.init=function(){var e=this;this.initialClasses=Array.from(this.element.classList),this.element.classList.add(this.className),this._initSlides(),this.state.next=this.slides.length&&1,this.state.prev=this.slides.length&&this.slides.length-1,t.on("navigate",function(t){return e._onNavigate(t)})},s.prototype.getCurrentSlide=function(){return this.slides[this.state.currentSlide].element},s.prototype._initSlides=function(){var e=this,t=Array.from(this.element.querySelectorAll(this.slideSelector))||this.element.children;if(2===t.length){var i=t[0].cloneNode(!0);this.element.appendChild(i),t.push(i)}this.state.slideLength=t.length-1;var s=Array.from(t).map(function(t,i){return new n({parentSection:e,element:t,index:i})});this.slides=s},s.prototype._onNavigate=function(e){i(this,e)};var r=function(e){var t=e.state,i=e.currentKey,n=e.direction,s=e.currentIndex,r=e.length;if(Number.isInteger(n))t[i]=n;else switch(n){case"next":s!==r?t[i]+=1:t[i]=0;break;case"prev":0!==s?t[i]-=1:t[i]=r}t.next=t[i]===r?0:t[i]+1,t.prev=0===t[i]?r:t[i]-1},a=function(e,t){t.currentTime=(new Date).getTime();var i=(e=window.event||e||e.originalEvent).wheelData||-e.deltaY||-e.detail,n=Math.max(-1,Math.min(1,i));t.scrolls.length>=150&&t.scrolls.shift(),t.scrolls.push(Math.abs(i));var s=t.currentTime-t.prevTime;t.prevTime=t.currentTime,s>50&&(t.scrolls=[]);var r=function(e){var i=Math.max(t.scrolls.length-e,1);return t.scrolls.slice(i).reduce(function(e,t){return e+t},0)/e};t.state.isAnimating||r(10)>=r(70)&&s>=50&&t.navigate("section",n<0?"next":"prev")},c=function(e){void 0===e&&(e={keyboardEvents:!0}),Object.assign(this,e),this.baseSelector="js-deck3000",this.element=document.querySelector("."+this.baseSelector),this.emitter=t,this.state={current:0,next:1},this.init()};return c.prototype.init=function(){var e=this,i=this.state.current,n=Array.from(this.element.children).map(function(t,i){return new s({slideshow:e,slideSelector:e.slideSelector,element:t,index:i})});this.state.sectionLength=this.state.prev=n.length-1,this.sections=n,this._attachEventHandlers(),t.emit("navigate",this.state),t.emit("navigateSlide",{current:i}),setTimeout(function(){e.element.classList.add("is-init"),e.transitionDuration=1e3*parseFloat(getComputedStyle(e.sections[0].element).transitionDuration)},0)},c.prototype._attachEventHandlers=function(){var e,t,i,n,s,r=this;this.scrolls=[],this.prevTime=(new Date).getTime(),this.element.addEventListener("mousewheel",function(e){a(e,r)}),this.element.addEventListener("DOMMouseScroll",function(e){a(e,r)}),e=this,t=0,i=0,n=0,s=0,("ontouchstart"in window||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints)&&(e.element.addEventListener("touchstart",function(e){t=e.changedTouches[0].screenX,i=e.changedTouches[0].screenY},!1),e.element.addEventListener("touchend",function(r){n=r.changedTouches[0].screenX,s=r.changedTouches[0].screenY;var a=Math.abs(n-t)>=100,c=Math.abs(s-i)>=100;return n<=t&&a?e.navigate("slide","next"):n>=t&&a?e.navigate("slide","prev"):s>=i&&c?e.navigate("section","prev"):s<=i&&c?e.navigate("section","next"):void 0},!1)),this.keyboardEvents||window.addEventListener("keyup",function(e){if(!r.state.isAnimating)switch(e.keyCode){case 38:r.navigate("section","prev");break;case 40:r.navigate("section","next");break;case 37:r.navigate("slide","prev");break;case 39:r.navigate("slide","next")}})},c.prototype.disableEvents=function(e){this.noEvents=e},c.prototype.navigate=function(e,i,n,s){if(void 0===n&&(n=!0),!this.noEvents&&!this.state.isAnimating){var a=this.state,c=a.current,o=a.sectionLength,l=this.sections[c],h="section"===e;if(this.state.direction=i,"section"===e&&(r({state:this.state,currentKey:"current",currentIndex:c,length:o,direction:i}),t.emit("navigate",this.state)),"slide"===e){if(0===l.state.slideLength)return;var d=l.state;r({state:l.state,currentKey:"currentSlide",currentIndex:d.currentSlide,length:d.slideLength,direction:i}),t.emit("navigateSlide",{current:c,direction:i,reset:s})}this.resetSlides&&h&&this.navigate("slide",0,!1,!0),n&&this.callback(e)}},c.prototype.callback=function(e){var t=this,i=this.sections[this.state.current],n={section:this.state,slide:i.state,currentSectionElem:i.element,currentSlideElem:i.getCurrentSlide()},s="section"===e,r=s?this.onSectionStart:this.onSlideStart,a=s?this.onSectionEnd:this.onSlideEnd;this.state.isAnimating=!0,clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.state.isAnimating=!1},this.transitionDuration),r&&r(n),a&&a(n)},c});
//# sourceMappingURL=deck3000.umd.js.map
